<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Topaz Quiz</title>
    <!-- Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Basic Tailwind configuration for dark mode
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Sarabun:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom Styles -->
    <style>
        html {
            transition: background-color 0.2s, color 0.2s;
        }
        body {
            font-family: 'Sarabun', 'Inter', sans-serif;
        }
        .reasoning {
            transition: opacity 0.5s ease-in-out, max-height 0.5s ease-in-out;
        }
        .pharma-tab-btn.active {
            border-color: #2563eb; /* blue-600 */
            background-color: #2563eb;
            color: white;
        }
        .dark .pharma-tab-btn.active {
            border-color: #3b82f6; /* blue-500 */
            background-color: #3b82f6;
            color: white;
        }
        .pharma-tab-btn { white-space: nowrap; }
        /* Styles for the sidebar navigation menus */
        #sidebar-nav-container { position: relative; width: 100%; height: calc(100% - 65px); overflow-x: hidden; }
        .nav-menu { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transition: transform 0.3s ease-in-out; }
        .nav-menu.main-menu { transform: translateX(0); }
        .nav-menu.sub-menu { transform: translateX(100%); }
        .nav-menu.show { transform: translateX(0); }
        .nav-menu.hide-left { transform: translateX(-100%); }

        /* Snake Game Styles */
        #game-board {
            touch-action: none;
            display: grid;
            grid-template-rows: repeat(20, 1fr);
            grid-template-columns: repeat(20, 1fr);
            width: 400px;
            height: 400px;
            max-width: 90vw;
            max-height: 90vw;
            background-color: #4A6572;
            border: 5px solid #1B263B;
            margin: auto;
        }
        .snake { background-color: #40E0D0; border-radius: 20%; }
        .food { background-color: #E67E22; border-radius: 50%; }
        .dead-snake { 
            color: rgb(0, 0, 0);
            font-size: 1.2rem;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200">

    <!-- Sidebar: Navigation menu for topics. Initially hidden off-screen. -->
    <aside id="sidebar" class="fixed top-0 left-0 z-40 w-64 h-screen bg-white dark:bg-gray-800 shadow-xl transform -translate-x-full transition-transform duration-300 ease-in-out">
        <div class="p-4 border-b border-gray-200 dark:border-gray-700">
            <h2 class="text-xl font-bold text-gray-800 dark:text-gray-100">Topics</h2>
        </div>
        <!-- Container for sliding navigation menus -->
        <div id="sidebar-nav-container">
            <!-- Main navigation menu -->
            <nav id="main-menu" class="nav-menu main-menu mt-4">
                <ul>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="homeContent">Home</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="miniGameContent">Mini-Game</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="pharmacologyContent">Pharmacology</a></li>
                    <li><a href="#" id="infectious-menu-btn" class="flex justify-between items-center w-full py-2 px-4"><span>Infectious</span><span>&gt;</span></a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="epidemiologyContent">Epidemiology</a></li>
                    <!-- Placeholder links for future content -->
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="placeholderContent">Skin</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="placeholderContent">Musculoskeletal</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="placeholderContent">CNS</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="placeholderContent">Urban Health</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="placeholderContent">Cardiovascular</a></li>
                </ul>
            </nav>
            <!-- Sub-menu for the "Infectious" category -->
            <nav id="infectious-sub-menu" class="nav-menu sub-menu mt-4">
                <ul>
                    <li><a href="#" id="back-to-main-menu" class="block py-2 px-4">&lt;- Back</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="infectiousContent" data-sub-target="theorySum1Content">Theory SUM1</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="infectiousContent" data-sub-target="labSum1Content">Lab SUM1</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="infectiousContent" data-sub-target="theorySum2Content">Theory SUM2</a></li>
                    <li><a href="#" class="sidebar-link block py-2 px-4" data-target="infectiousContent" data-sub-target="labSum2Content">Lab SUM2</a></li>
                </ul>
            </nav>
        </div>
    </aside>

    <!-- Overlay: Shown behind the sidebar when it's open -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden transition-opacity duration-300 ease-in-out"></div>

    <!-- Main Content Area -->
    <div id="main-content" class="transition-all duration-300 ease-in-out">
        <!-- Header: Contains menu button, title, and theme toggle -->
        <header class="bg-white dark:bg-gray-800 shadow-md sticky top-0 z-20 border-b border-gray-200 dark:border-gray-700">
            <div class="container mx-auto px-4 py-3 flex items-center justify-between">
                <div class="flex items-center">
                    <button id="menu-btn" class="p-2 rounded-md text-gray-600 dark:text-gray-300">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                    </button>
                    <h1 class="text-xl font-bold ml-4 text-gray-900 dark:text-gray-100">Topaz Quiz</h1>
                </div>
                <button id="theme-toggle" class="p-2 rounded-md text-gray-600 dark:text-gray-300">
                    <svg id="theme-toggle-dark-icon" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
                    <svg id="theme-toggle-light-icon" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                </button>
            </div>
        </header>

        <!-- Container for all dynamic content panes -->
        <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">
            
            <!-- Progress Tracker: Displayed during a quiz -->
            <div id="progress-tracker" class="mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md hidden">
                <div class="flex justify-between items-center text-sm text-gray-600 dark:text-gray-300 mb-2 flex-wrap">
                    <span>Answered: <b id="answered-count">0</b>/<b id="total-count">0</b></span>
                    <span class="text-green-500">✅ Correct: <b id="correct-count">0</b></span>
                    <span class="text-red-500">❌ Incorrect: <b id="incorrect-count">0</b></span>
                    <span>Remaining: <b id="remaining-count">0</b></span>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                    <div id="progress-bar-fill" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
                <div id="retry-buttons" class="mt-4 text-center">
                    <button id="retry-btn" class="bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg">Retry Quiz</button>
                    <button id="retry-incorrect-btn" class="bg-orange-500 text-white font-semibold py-2 px-4 rounded-lg ml-2">Retry Incorrect</button>
                </div>
            </div>

            <!-- Home Content Pane -->
            <div id="homeContent" class="main-content-pane">
                <div class="flex flex-col items-center justify-center text-center min-h-[70vh]">
                    <h1 class="text-5xl md:text-6xl font-bold">Topaz Quiz</h1>
                    <p class="text-xl mt-4 mb-8">Let's get started</p>
                    <button id="start-btn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg">Let's get started</button>
                </div>
                <div class="fixed bottom-4 right-4 text-xs text-gray-400">
                    <p>Made by Topasz711</p>
                    <p>Follow me on <a href="https://github.com/Topasz711" target="_blank" class="text-blue-400 hover:underline">GitHub</a></p>
                </div>
            </div>

            <!-- Pharmacology Content Pane -->
            <div id="pharmacologyContent" class="main-content-pane hidden">
                <!-- Tabs for different pharmacology quizzes -->
                <div class="mb-8 border-b border-gray-300 dark:border-gray-700 overflow-x-auto">
                    <div class="flex -mb-px">
                        <button class="pharma-tab-btn lecture-btn flex-shrink-0 py-2 px-4" data-quiz-file="pharmaco/para-quiz.json" data-quiz-container="pharmaQuizContainer" data-quiz-title="Parasympathomimetic & Parasympatholytic Drugs Quiz" data-quiz-subtitle="Test your knowledge on cholinergic pharmacology.">Parasympathomimetic Drugs</button>
                        <button class="pharma-tab-btn lecture-btn flex-shrink-0 py-2 px-4" data-quiz-file="pharmaco/gluco-quiz.json" data-quiz-container="pharmaQuizContainer" data-quiz-title="Glucocorticoids Quiz" data-quiz-subtitle="Test your knowledge on glucocorticoid pharmacology.">Glucocorticoids</button>
                        <!-- Add other pharma tabs here -->
                    </div>
                </div>
                <!-- View for the pharmacology quiz -->
                <div id="pharmaQuizView">
                    <header class="text-center mb-8">
                        <h1 id="pharma-quiz-title" class="text-3xl sm:text-4xl font-bold"></h1>
                        <p id="pharma-quiz-subtitle" class="mt-2 text-lg"></p>
                    </header>
                    <div id="pharmaQuizContainer" class="space-y-8"></div>
                </div>
            </div>

            <!-- Infectious Disease Content Pane -->
            <div id="infectiousContent" class="main-content-pane hidden">
                <!-- Sub-pane for Theory SUM1 lectures -->
                <div id="theorySum1Content" class="infectious-sub-pane">
                    <h2 class="text-2xl font-bold mb-4">Theory SUM1</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <button class="lecture-btn" data-quiz-type="mcq" data-quiz-file="infectious/infectious-theory1-L1.json" data-quiz-container="infectiousQuizContainer" data-quiz-title="L1: Introduction to Medical Parasitology"><b>L1:</b> Introduction to Medical Parasitology</button>
                        <!-- Add other infectious theory buttons here -->
                    </div>
                </div>
                <!-- Sub-pane for Lab SUM1 lectures -->
                <div id="labSum1Content" class="infectious-sub-pane hidden">
                    <h2 class="text-2xl font-bold mb-4">Lab SUM1</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <button class="lecture-btn" data-quiz-type="lab" data-quiz-file="infectious/infectious-lab1-L1.json" data-quiz-container="infectiousLabQuizContainer" data-quiz-title="Lab 1: Medical Helminthes"><b>Lab 1:</b> Medical Helminthes</button>
                        <!-- Add other infectious lab buttons here -->
                    </div>
                </div>
                <!-- Views for the infectious disease quizzes -->
                <div id="infectiousQuizView" class="infectious-sub-pane hidden">
                    <header class="text-center mb-8">
                        <h1 id="infectious-quiz-title" class="text-3xl sm:text-4xl font-bold"></h1>
                        <p class="mt-2 text-lg">Test your knowledge.</p>
                    </header>
                    <div id="infectiousQuizContainer" class="space-y-8"></div>
                </div>
                <div id="infectiousLabQuizView" class="infectious-sub-pane hidden">
                    <header class="text-center mb-8">
                        <h1 id="infectious-lab-quiz-title" class="text-3xl sm:text-4xl font-bold"></h1>
                        <p class="mt-2 text-lg">Answer the following questions.</p>
                    </header>
                    <div id="infectiousLabQuizContainer" class="space-y-8"></div>
                </div>
                <!-- Placeholder for unavailable infectious content -->
                <div id="infectiousPlaceholder" class="infectious-sub-pane hidden text-center p-10">
                    <h2 class="text-2xl font-semibold">Content Not Available</h2>
                </div>
            </div>

            <!-- Epidemiology Content Pane -->
            <div id="epidemiologyContent" class="main-content-pane hidden">
                <div id="epidemiologyListView">
                    <h2 class="text-2xl font-bold mb-4">Epidemiology Lectures</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                         <button class="lecture-btn" data-quiz-type="mcq" data-quiz-file="epidemiology/epi-L1.json" data-quiz-container="epidemiologyQuizContainer" data-quiz-title="L1: Natural History"><b>L1:</b> Natural History</button>
                         <!-- Add other epidemiology lecture buttons here -->
                    </div>
                </div>
                <div id="epidemiologyQuizView" class="hidden">
                    <header class="text-center mb-8">
                        <h1 id="epidemiology-quiz-title" class="text-3xl sm:text-4xl font-bold"></h1>
                        <p class="mt-2 text-lg">Test your knowledge.</p>
                    </header>
                    <div id="epidemiologyQuizContainer" class="space-y-8"></div>
                </div>
            </div>
            
            <!-- Mini-Game Content Pane -->
            <div id="miniGameContent" class="main-content-pane hidden">
                <h2 class="text-2xl font-bold mb-4 text-center">Snake Game</h2>
                <div class="text-center mb-4">
                    <span class="text-lg">Score: <b id="score">0</b></span>
                    <span class="text-lg ml-4">High Score: <b id="high-score">0</b></span>
                </div>
                <div id="game-board" tabindex="0"></div>
                <div class="text-center mt-4">
                    <button id="pause-resume-btn" class="bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg">Pause</button>
                    <button id="restart-game-btn" class="bg-green-500 text-white font-semibold py-2 px-4 rounded-lg ml-2">Restart</button>
                </div>
                <div class="text-center mt-2 text-sm text-gray-500">
                    Use Arrow Keys or Swipe to move.
                </div>
            </div>

            <!-- Placeholder for uncreated content -->
            <div id="placeholderContent" class="main-content-pane hidden text-center p-10">
                <h2 class="text-2xl font-semibold">Content Not Available</h2>
                <p class="mt-2">(Not yet available / Might not be created)</p>
            </div>
        </div>
    </div>

    <!-- Main JavaScript file -->
    <script src="main.js" defer></script>
</body>
</html>